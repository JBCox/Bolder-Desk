<form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4">
    @for(field of visibleFields(); track field.id) {
        <div>
            <label [for]="field.id" class="block text-sm font-medium text-gray-700 dark:text-slate-300">
                {{ field.label }} 
                @if(field.required){<span class="text-red-500">*</span>}
            </label>
            <div class="mt-1">
                @switch (field.type) {
                    @case('text') { 
                        <input type="text" [id]="field.id" [formControlName]="field.name" class="form-input">
                    }
                    @case('textarea') { 
                        <textarea rows="4" [id]="field.id" [formControlName]="field.name" class="form-input"></textarea>
                    }
                    @case('dropdown') { 
                      <select [id]="field.id" [formControlName]="field.name" class="form-input">
                        @for(option of field.options; track option) { <option [value]="option">{{option}}</option> }
                      </select>
                    }
                    @case('checkbox') { 
                      <div class="flex items-center">
                        <input type="checkbox" [id]="field.id" [formControlName]="field.name" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                      </div>
                    }
                    @case('radio') {
                      <div class="flex items-center space-x-4">
                        @for(option of field.options; track option) {
                          <label class="flex items-center">
                            <input type="radio" [name]="field.name" [value]="option" [formControlName]="field.name" class="h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <span class="ml-2 text-sm text-gray-900 dark:text-slate-200">{{option}}</span>
                          </label>
                        }
                      </div>
                    }
                }
            </div>
            @if(form.controls[field.name].invalid && form.controls[field.name].touched) {
                <p class="mt-1 text-sm text-red-600">This field is required.</p>
            }
        </div>
    }

    <div class="pt-4 text-right">
      <button type="submit" class="inline-flex justify-center py-2 px-6 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">Create Ticket</button>
    </div>
</form>

<style>
.form-input {
  @apply block w-full text-sm border-gray-300 dark:border-slate-600 rounded-md bg-white dark:bg-slate-700 text-slate-800 dark:text-slate-200;
}
</style>